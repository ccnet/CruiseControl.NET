<html>
    <head>
        <title>CruiseControl.NET : SourceGear Vault Source Control Block</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            CruiseControl.NET : SourceGear Vault Source Control Block
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Sep 13, 2005 by <font color="#0050B2">orogers</font>.
				    </div>

				    <h3><a name="SourceGearVaultSourceControlBlock-SourceGearVaultConfigurationExamples">SourceGear Vault Configuration Examples</a></h3>

<p>Minimal example:</p>

<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;sourcecontrol type=<span class="code-quote">"vault"</span> /&gt;</span></pre>
</div></div>

<p>Full example:</p>

<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;sourcecontrol type=<span class="code-quote">"vault"</span> autoGetSource=<span class="code-quote">"true"</span> applyLabel=<span class="code-quote">"true"</span>&gt;</span>
           <span class="code-tag">&lt;executable&gt;</span>c:\program files\sourcegear\vault client\vault.exe<span class="code-tag">&lt;/executable&gt;</span>
           <span class="code-tag">&lt;username&gt;</span>my_username<span class="code-tag">&lt;/username&gt;</span>
            <span class="code-tag">&lt;password&gt;</span>my_password<span class="code-tag">&lt;/password&gt;</span>
            <span class="code-tag">&lt;host&gt;</span>my_buildserver<span class="code-tag">&lt;/host&gt;</span>
            <span class="code-tag">&lt;repository&gt;</span>my_repository<span class="code-tag">&lt;/repository&gt;</span>
            <span class="code-tag">&lt;folder&gt;</span>$<span class="code-tag">&lt;/folder&gt;</span>
	    <span class="code-tag">&lt;ssl&gt;</span>true<span class="code-tag">&lt;/ssl&gt;</span>
	    <span class="code-tag">&lt;useWorkingDirectory&gt;</span>true<span class="code-tag">&lt;/useWorkingDirectory&gt;</span>
<span class="code-tag">&lt;/sourcecontrol&gt;</span></pre>
</div></div>

<h3><a name="SourceGearVaultSourceControlBlock-ConfigurationElements%3A">Configuration Elements:</a></h3>

<table class='confluenceTable'>
<tr>
<th class='confluenceTh'> Node </th>
<th class='confluenceTh'> Description </th>
<th class='confluenceTh'> Type </th>
<th class='confluenceTh'> Required </th>
<th class='confluenceTh'> Default </th>
</tr>
<tr>
<td class='confluenceTd'> executable </td>
<td class='confluenceTd'> The location of the vault command-line executable </td>
<td class='confluenceTd'> string </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> C:\Program Files\SourceGear\Vault Client\vault.exe </td>
</tr>
<tr>
<td class='confluenceTd'> username</td>
<td class='confluenceTd'> Vault user id that CCNet should use to authenticate </td>
<td class='confluenceTd'> string </td>
<td class='confluenceTd'> false <a href="#SourceGearVaultSourceControlBlock-optional" title="optional on SourceGear Vault Source Control Block">*</a> </td>
<td class='confluenceTd'> null </td>
</tr>
<tr>
<td class='confluenceTd'> password </td>
<td class='confluenceTd'> Password for the Vault user </td>
<td class='confluenceTd'> string </td>
<td class='confluenceTd'> false <a href="#SourceGearVaultSourceControlBlock-optional" title="optional on SourceGear Vault Source Control Block">*</a> </td>
<td class='confluenceTd'> null </td>
</tr>
<tr>
<td class='confluenceTd'> host </td>
<td class='confluenceTd'> The name of the Vault server </td>
<td class='confluenceTd'> string </td>
<td class='confluenceTd'> false <a href="#SourceGearVaultSourceControlBlock-optional" title="optional on SourceGear Vault Source Control Block">*</a> </td>
<td class='confluenceTd'> null </td>
</tr>
<tr>
<td class='confluenceTd'> repository </td>
<td class='confluenceTd'> The name of the Vault repository to monitor. </td>
<td class='confluenceTd'> string </td>
<td class='confluenceTd'> false <a href="#SourceGearVaultSourceControlBlock-optional" title="optional on SourceGear Vault Source Control Block">*</a> </td>
<td class='confluenceTd'> null </td>
</tr>
<tr>
<td class='confluenceTd'> folder </td>
<td class='confluenceTd'> The root folder to be monitored by CCNet </td>
<td class='confluenceTd'> string </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> $ </td>
</tr>
<tr>
<td class='confluenceTd'> ssl </td>
<td class='confluenceTd'> Should SSL be used to communicate with the Vault server. </td>
<td class='confluenceTd'> bool </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> false </td>
</tr>
<tr>
<td class='confluenceTd'> autoGetSource </td>
<td class='confluenceTd'> Specifies if CCNet should automatically retrieve the latest version of the source from the repository </td>
<td class='confluenceTd'> bool </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> false </td>
</tr>
<tr>
<td class='confluenceTd'> applyLabel </td>
<td class='confluenceTd'> Specifies if CCNet should apply the build label to the repository </td>
<td class='confluenceTd'> bool </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> false </td>
</tr>
<tr>
<td class='confluenceTd'> useWorkingDirectory </td>
<td class='confluenceTd'> Specify if CCNet should use the working directory that is set up in Vault or if it should override it using the CCNet working directory. </td>
<td class='confluenceTd'> bool </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> true </td>
</tr>
<tr>
<td class='confluenceTd'> historyArgs </td>
<td class='confluenceTd'> Extra arguments to be included in the history commandline  </td>
<td class='confluenceTd'> string </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> -excludeactions label -rowlimit 0 </td>
</tr>
<tr>
<td class='confluenceTd'> timeout </td>
<td class='confluenceTd'> How long (in milliseconds) the operation will be permitted to run before timing out.  The default value is 10 minutes. </td>
<td class='confluenceTd'> int </td>
<td class='confluenceTd'> false </td>
<td class='confluenceTd'> 10 minutes </td>
</tr>
</table>

<p><a name="SourceGearVaultSourceControlBlock-optional"></a>*: it is possible to deposit these values with the Vault client so that they do not need to be stored in the ccnet.config file.</p>

<h3><a name="SourceGearVaultSourceControlBlock-GettingthelatestsourcefromVault">Getting the latest source from Vault</a></h3>

<p><img class="emoticon" src="./icons/emoticons/warning.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> NOTE: as of 0.9.2, CCNet now supports automatically getting the latest version of the source from Vault.  The NAnt bootstrap file is no longer necessary.</p>

<h3><a name="SourceGearVaultSourceControlBlock-FilteringoutLabelChanges">Filtering out Label Changes</a></h3>

<p>Vault interprets new labels as changes, so if you apply a label as part of your build process, this will kick off another build. To get around this, use a <a href="Filtered Source Control Block.html" title="Filtered Source Control Block">Filtered Source Control Block</a>.  If your build server uses a specific user id to integrate with Vault, you can set up a UserFilter to filter out all changes made by that user.</p>

<h3><a name="SourceGearVaultSourceControlBlock-ProblemswithCCServiceandVault3.0.2">Problems with CCService and Vault 3.0.2+</a></h3>
<p>If you are experiencing problems detecting modifications using CCService after upgrading to Vault 3.0.2, it may be related to the enhanced security features of the Vault server.  You should try the following process to fix this issue:</p>
<ul>
	<li>reinstall the Vault Server to have the IIS Process Model run as System (ie. not Machine)</li>
	<li>change the CCService to run as an actual user, not as LocalSystem.</li>
</ul>


<h3><a name="SourceGearVaultSourceControlBlock-ProblemswithreleasespriortoVault3.0">Problems with releases prior to Vault 3.0</a></h3>
<p>For versions of Vault prior to 3.0, the <b>-excludeactions</b> argument is not supported.  To get around this problem you should explicitly specify the <b>&lt;historyArgs&gt;</b> element in your <b>ccnet.config</b> file so that it does not contain that argument (ie. set it to &lt;historyArgs&gt;-rowlimit 0&lt;/historyArgs&gt;.</p>


<p>Code contributed by Ryan Duffield and Leo von Wyss.</p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="border/border_bottom.gif"><img src="border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Sep 18, 2005 21:17</font></td>
		    </tr>
	    </table>
    </body>
</html>